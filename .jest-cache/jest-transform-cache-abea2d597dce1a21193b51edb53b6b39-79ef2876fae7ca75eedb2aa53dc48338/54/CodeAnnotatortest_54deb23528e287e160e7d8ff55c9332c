c67e6de5a6354bd1a835d300a2abe53e
"use strict";
/**
 * CodeAnnotator Tests
 * v0.8.0 - Phase 4: Context Engineering
 *
 * コードアノテーション機能のテスト
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// モックファイルシステム
jest.mock('fs/promises');
const CodeAnnotator_1 = require("../../src/reporting/CodeAnnotator");
const AnnotationGenerator_1 = require("../../src/reporting/AnnotationGenerator");
const types_1 = require("../../src/reporting/types");
const fs = __importStar(require("fs/promises"));
const path = __importStar(require("path"));
const mockFs = fs;
// モックファイルの内容（グローバルに定義）
const mockFileContents = {
    '/tmp/rimor-test/db.ts': `export class Database {
  constructor(private config: any) {}
  
  async query(sql: string) {
    // Some code before
    console.log('Query:', sql);
    
    // Line 8
    // Line 9
    const result = await this.db.query(sql); // Line 10 - SQL injection here
    // Line 11
    return result;
  }
}`,
    '/tmp/rimor-test/api.ts': `import express from 'express';

export function setupRoutes(app: express.Application) {
  app.get('/user/:id', async (req, res) => {
    const userId = req.params.id;
    
    // Some code...
    // Line 7
    // Line 8
    // Line 9
    // Line 10
    // Line 11
    // Line 12
    // Line 13
    // Line 14
    // Line 15
    // Line 16
    // Line 17
    // Line 18
    // Line 19
    res.send('<h1>Welcome ' + userId + '</h1>'); // Line 20 - XSS here
    
    // More code...
    // Line 22
    // Line 23
    // Line 24
    // Line 25
    // Line 26
    // Line 27
    // Line 28
    // Line 29
    console.log('Test'); // Line 30 - Test quality issue
  });
}`
};
describe('CodeAnnotator', () => {
    let annotator;
    let generator;
    let tempDir = '/tmp/rimor-test';
    beforeEach(() => {
        generator = new AnnotationGenerator_1.AnnotationGenerator();
        annotator = new CodeAnnotator_1.CodeAnnotator(generator);
        // テスト用一時ディレクトリ（固定値にして予測可能にする）
        tempDir = '/tmp/rimor-test';
        // fsモックのリセット
        jest.clearAllMocks();
        // デフォルトのモック設定
        mockFs.readFile.mockImplementation((filePath) => {
            const normalizedPath = typeof filePath === 'string' ? filePath : filePath.toString();
            const content = mockFileContents[normalizedPath];
            if (content) {
                return Promise.resolve(content);
            }
            return Promise.reject(new Error('File not found'));
        });
    });
    afterEach(() => {
        // モックをリセット
        jest.clearAllMocks();
    });
    describe('annotateFiles', () => {
        const mockResult = {
            metadata: {
                version: '0.8.0',
                timestamp: new Date().toISOString(),
                analyzedPath: tempDir,
                duration: 1000
            },
            summary: {
                totalFiles: 2,
                totalIssues: 3,
                issueBySeverity: {
                    critical: 1,
                    high: 1,
                    medium: 1,
                    low: 0,
                    info: 0
                },
                issueByType: {
                    'SQL_INJECTION': 1,
                    'XSS': 1,
                    'TEST_QUALITY': 1
                }
            },
            issues: [
                {
                    id: '1',
                    type: types_1.IssueType.SQL_INJECTION,
                    severity: types_1.Severity.CRITICAL,
                    category: 'security',
                    location: {
                        file: path.join(tempDir, 'db.ts'),
                        startLine: 10,
                        endLine: 10
                    },
                    message: 'SQL Injection vulnerability'
                },
                {
                    id: '2',
                    type: types_1.IssueType.XSS,
                    severity: types_1.Severity.HIGH,
                    category: 'security',
                    location: {
                        file: path.join(tempDir, 'api.ts'),
                        startLine: 20,
                        endLine: 20
                    },
                    message: 'XSS vulnerability'
                },
                {
                    id: '3',
                    type: types_1.IssueType.TEST_QUALITY,
                    severity: types_1.Severity.MEDIUM,
                    category: 'test-quality',
                    location: {
                        file: path.join(tempDir, 'api.ts'),
                        startLine: 30,
                        endLine: 30
                    },
                    message: 'Test quality issue'
                }
            ],
            metrics: {
                testCoverage: { overall: 80, byModule: {} },
                codeQuality: {}
            }
        };
        it('should annotate multiple files with issues', async () => {
            // モックが正しく設定されていることを確認
            mockFs.readFile.mockImplementation((filePath) => {
                const normalizedPath = typeof filePath === 'string' ? filePath : filePath.toString();
                const content = mockFileContents[normalizedPath];
                if (content) {
                    return Promise.resolve(content);
                }
                return Promise.reject(new Error('File not found'));
            });
            const annotations = await annotator.annotateFiles(mockResult);
            expect(annotations).toHaveLength(2); // 2つのファイル
            // db.tsのアノテーション
            const dbAnnotation = annotations.find(a => a.filePath.endsWith('db.ts'));
            expect(dbAnnotation).toBeDefined();
            expect(dbAnnotation.annotationCount).toBe(1);
            expect(dbAnnotation.annotatedContent).toContain('// RIMOR-CRITICAL:');
            expect(dbAnnotation.annotatedContent).toContain('SQL Injection vulnerability');
            // api.tsのアノテーション
            const apiAnnotation = annotations.find(a => a.filePath.endsWith('api.ts'));
            expect(apiAnnotation).toBeDefined();
            expect(apiAnnotation.annotationCount).toBe(2);
            expect(apiAnnotation.annotatedContent).toContain('// RIMOR-HIGH:');
            expect(apiAnnotation.annotatedContent).toContain('XSS vulnerability');
            expect(apiAnnotation.annotatedContent).toContain('// RIMOR-MEDIUM:');
            expect(apiAnnotation.annotatedContent).toContain('Test quality issue');
        });
        it('should preserve indentation when adding annotations', async () => {
            const annotations = await annotator.annotateFiles(mockResult);
            const dbAnnotation = annotations.find(a => a.filePath.endsWith('db.ts'));
            const lines = dbAnnotation.annotatedContent.split('\n');
            // アノテーションが正しいインデントで挿入されていることを確認
            const annotationLine = lines.find(line => line.includes('RIMOR-CRITICAL'));
            expect(annotationLine).toMatch(/^    \/\/ RIMOR-CRITICAL:/); // 4スペースのインデント
        });
        it('should handle files that cannot be read', async () => {
            // 読み込みエラーをシミュレート - 特定のファイルのみエラー
            mockFs.readFile.mockImplementation((filePath) => {
                const normalizedPath = typeof filePath === 'string' ? filePath : filePath.toString();
                if (normalizedPath.endsWith('db.ts')) {
                    return Promise.reject(new Error('Permission denied'));
                }
                const content = mockFileContents[normalizedPath];
                if (content) {
                    return Promise.resolve(content);
                }
                return Promise.reject(new Error('File not found'));
            });
            const annotations = await annotator.annotateFiles(mockResult);
            // エラーが発生したファイルはスキップされる
            expect(annotations).toHaveLength(1); // api.tsのみ
        });
        it('should apply block format when specified', async () => {
            // モックをリセットして正常な読み込みに戻す
            mockFs.readFile.mockImplementation((filePath) => {
                const normalizedPath = typeof filePath === 'string' ? filePath : filePath.toString();
                const content = mockFileContents[normalizedPath];
                if (content) {
                    return Promise.resolve(content);
                }
                return Promise.reject(new Error('File not found'));
            });
            const options = {
                format: 'block'
            };
            const annotations = await annotator.annotateFiles(mockResult, options);
            const dbAnnotation = annotations.find(a => a.filePath.endsWith('db.ts'));
            expect(dbAnnotation.annotatedContent).toContain('/*');
            expect(dbAnnotation.annotatedContent).toContain(' * RIMOR Security Analysis Report');
            expect(dbAnnotation.annotatedContent).toContain(' */');
        });
    });
    describe('saveAnnotatedFiles', () => {
        const mockAnnotations = [
            {
                filePath: path.join(tempDir, 'db.ts'),
                originalContent: 'original db content',
                annotatedContent: 'annotated db content',
                annotationCount: 1
            },
            {
                filePath: path.join(tempDir, 'api.ts'),
                originalContent: 'original api content',
                annotatedContent: 'annotated api content',
                annotationCount: 2
            }
        ];
        beforeEach(() => {
            mockFs.writeFile.mockResolvedValue(undefined);
            mockFs.mkdir.mockResolvedValue(undefined);
            mockFs.access.mockRejectedValue(new Error('Not found')); // ディレクトリが存在しない
        });
        it('should save annotated files to original location when overwrite is true', async () => {
            const options = {
                overwrite: true
            };
            await annotator.saveAnnotatedFiles(mockAnnotations, undefined, options);
            expect(mockFs.writeFile).toHaveBeenCalledTimes(2);
            expect(mockFs.writeFile).toHaveBeenCalledWith(path.join(tempDir, 'db.ts'), 'annotated db content', 'utf-8');
            expect(mockFs.writeFile).toHaveBeenCalledWith(path.join(tempDir, 'api.ts'), 'annotated api content', 'utf-8');
        });
        it('should save to output directory when specified', async () => {
            const outputDir = path.join(tempDir, 'annotated');
            await annotator.saveAnnotatedFiles(mockAnnotations, outputDir);
            expect(mockFs.mkdir).toHaveBeenCalled();
            expect(mockFs.writeFile).toHaveBeenCalledTimes(2);
            // 実際の書き込み内容を確認
            const calls = mockFs.writeFile.mock.calls;
            // ファイルが正しく書き込まれたことを確認
            expect(calls).toHaveLength(2);
            // 各呼び出しが正しいコンテンツを持っているか確認
            const dbCall = calls.find(call => call[1] === 'annotated db content');
            const apiCall = calls.find(call => call[1] === 'annotated api content');
            expect(dbCall).toBeDefined();
            expect(apiCall).toBeDefined();
        });
        it('should create .annotated suffix when no output directory specified', async () => {
            await annotator.saveAnnotatedFiles(mockAnnotations);
            expect(mockFs.writeFile).toHaveBeenCalledWith(path.join(tempDir, 'db.annotated.ts'), 'annotated db content', 'utf-8');
            expect(mockFs.writeFile).toHaveBeenCalledWith(path.join(tempDir, 'api.annotated.ts'), 'annotated api content', 'utf-8');
        });
    });
    describe('generateAnnotationSummary', () => {
        it('should generate summary report', () => {
            const annotations = [
                {
                    filePath: '/project/src/db.ts',
                    originalContent: 'content1',
                    annotatedContent: 'annotated1',
                    annotationCount: 3
                },
                {
                    filePath: '/project/src/api.ts',
                    originalContent: 'content2',
                    annotatedContent: 'annotated2',
                    annotationCount: 2
                }
            ];
            const summary = annotator.generateAnnotationSummary(annotations);
            expect(summary).toContain('# Annotation Summary');
            expect(summary).toContain('Total files annotated: 2');
            expect(summary).toContain('Total annotations added: 5');
            expect(summary).toContain('- /project/src/db.ts: 3 annotations');
            expect(summary).toContain('- /project/src/api.ts: 2 annotations');
        });
        it('should handle empty annotations array', () => {
            const summary = annotator.generateAnnotationSummary([]);
            expect(summary).toContain('Total files annotated: 0');
            expect(summary).toContain('Total annotations added: 0');
            expect(summary).not.toContain('## Annotated Files:');
        });
    });
    describe('previewAnnotations', () => {
        const mockResult = {
            metadata: {
                version: '0.8.0',
                timestamp: new Date().toISOString(),
                analyzedPath: '/project',
                duration: 1000
            },
            summary: {
                totalFiles: 1,
                totalIssues: 2,
                issueBySeverity: {
                    critical: 1,
                    high: 1,
                    medium: 0,
                    low: 0,
                    info: 0
                },
                issueByType: {}
            },
            issues: [
                {
                    id: '1',
                    type: types_1.IssueType.SQL_INJECTION,
                    severity: types_1.Severity.CRITICAL,
                    category: 'security',
                    location: {
                        file: '/project/db.ts',
                        startLine: 10,
                        endLine: 10
                    },
                    message: 'SQL Injection'
                },
                {
                    id: '2',
                    type: types_1.IssueType.XSS,
                    severity: types_1.Severity.HIGH,
                    category: 'security',
                    location: {
                        file: '/project/db.ts',
                        startLine: 20,
                        endLine: 20
                    },
                    message: 'XSS vulnerability'
                }
            ],
            metrics: {
                testCoverage: { overall: 80, byModule: {} },
                codeQuality: {}
            }
        };
        it('should generate preview of annotations', () => {
            const preview = annotator.previewAnnotations(mockResult);
            expect(preview).toContain('# Annotation Preview');
            expect(preview).toContain('The following annotations would be added:');
            expect(preview).toContain('## /project/db.ts');
            expect(preview).toContain('Line 10:');
            expect(preview).toContain('// RIMOR-CRITICAL:');
            expect(preview).toContain('SQL Injection');
            expect(preview).toContain('Line 20:');
            expect(preview).toContain('// RIMOR-HIGH:');
            expect(preview).toContain('XSS vulnerability');
        });
        it('should show block format in preview when specified', () => {
            const options = {
                format: 'block'
            };
            const preview = annotator.previewAnnotations(mockResult, options);
            expect(preview).toContain('/*');
            expect(preview).toContain(' * RIMOR Security Analysis Report');
            expect(preview).toContain(' */');
        });
    });
    describe('cleanupAnnotations', () => {
        beforeEach(() => {
            mockFs.readFile.mockResolvedValue(`
export function test() {
  // RIMOR-HIGH: [high] XSS - XSS vulnerability
  const html = userInput;
  
  /* RIMOR Security Analysis Report
   * Issue: SQL_INJECTION
   */
  const query = sql;
  
  # RIMOR-CRITICAL: SQL Injection
  executeQuery(query);
  
  <!-- RIMOR-MEDIUM: Security issue -->
  return html;
}
`);
            mockFs.writeFile.mockResolvedValue(undefined);
        });
        it('should remove all RIMOR annotations', async () => {
            const result = await annotator.cleanupAnnotations('/test/file.ts');
            expect(result).toBe(true);
            expect(mockFs.writeFile).toHaveBeenCalled();
            const writtenContent = mockFs.writeFile.mock.calls[0][1];
            expect(writtenContent).not.toContain('RIMOR');
            expect(writtenContent).toContain('const html = userInput;');
            expect(writtenContent).toContain('const query = sql;');
        });
        it('should handle custom prefix', async () => {
            mockFs.readFile.mockResolvedValue(`
// SECURITY-HIGH: Custom annotation
const data = input;

// RIMOR-HIGH: Default annotation
const other = value;
`);
            await annotator.cleanupAnnotations('/test/file.ts', 'SECURITY');
            const writtenContent = mockFs.writeFile.mock.calls[0][1];
            expect(writtenContent).not.toContain('SECURITY-HIGH');
            expect(writtenContent).toContain('RIMOR-HIGH'); // 他のプレフィックスは残る
        });
        it('should return false if no annotations found', async () => {
            mockFs.readFile.mockResolvedValue(`
export function clean() {
  return 'no annotations here';
}
`);
            const result = await annotator.cleanupAnnotations('/test/file.ts');
            expect(result).toBe(false);
            expect(mockFs.writeFile).not.toHaveBeenCalled();
        });
        it('should handle file read errors', async () => {
            mockFs.readFile.mockRejectedValue(new Error('File not found'));
            const result = await annotator.cleanupAnnotations('/test/missing.ts');
            expect(result).toBe(false);
            expect(mockFs.writeFile).not.toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3Nhc2FrYW1hL1Byb2plY3RzL1JpbW9yL3Rlc3QvcmVwb3J0aW5nL0NvZGVBbm5vdGF0b3IudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZUgsY0FBYztBQUNkLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7QUFkekIscUVBQWtFO0FBQ2xFLGlGQUE4RTtBQUM5RSxxREFNbUM7QUFDbkMsZ0RBQWtDO0FBQ2xDLDJDQUE2QjtBQUs3QixNQUFNLE1BQU0sR0FBRyxFQUE0QixDQUFDO0FBRTVDLHVCQUF1QjtBQUN2QixNQUFNLGdCQUFnQixHQUEyQjtJQUMvQyx1QkFBdUIsRUFBRTs7Ozs7Ozs7Ozs7OztFQWF6QjtJQUNBLHdCQUF3QixFQUFFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7RUFpQzFCO0NBQ0QsQ0FBQztBQUVGLFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO0lBQzdCLElBQUksU0FBd0IsQ0FBQztJQUM3QixJQUFJLFNBQThCLENBQUM7SUFDbkMsSUFBSSxPQUFPLEdBQVcsaUJBQWlCLENBQUM7SUFFeEMsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLFNBQVMsR0FBRyxJQUFJLHlDQUFtQixFQUFFLENBQUM7UUFDdEMsU0FBUyxHQUFHLElBQUksNkJBQWEsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUV6Qyw4QkFBOEI7UUFDOUIsT0FBTyxHQUFHLGlCQUFpQixDQUFDO1FBRTVCLGFBQWE7UUFDYixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIsY0FBYztRQUNkLE1BQU0sQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxRQUFhLEVBQUUsRUFBRTtZQUNuRCxNQUFNLGNBQWMsR0FBRyxPQUFPLFFBQVEsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ3JGLE1BQU0sT0FBTyxHQUFHLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ2pELElBQUksT0FBTyxFQUFFLENBQUM7Z0JBQ1osT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ2xDLENBQUM7WUFDRCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsV0FBVztRQUNYLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQzdCLE1BQU0sVUFBVSxHQUE2QjtZQUMzQyxRQUFRLEVBQUU7Z0JBQ1IsT0FBTyxFQUFFLE9BQU87Z0JBQ2hCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtnQkFDbkMsWUFBWSxFQUFFLE9BQU87Z0JBQ3JCLFFBQVEsRUFBRSxJQUFJO2FBQ2Y7WUFDRCxPQUFPLEVBQUU7Z0JBQ1AsVUFBVSxFQUFFLENBQUM7Z0JBQ2IsV0FBVyxFQUFFLENBQUM7Z0JBQ2QsZUFBZSxFQUFFO29CQUNmLFFBQVEsRUFBRSxDQUFDO29CQUNYLElBQUksRUFBRSxDQUFDO29CQUNQLE1BQU0sRUFBRSxDQUFDO29CQUNULEdBQUcsRUFBRSxDQUFDO29CQUNOLElBQUksRUFBRSxDQUFDO2lCQUNSO2dCQUNELFdBQVcsRUFBRTtvQkFDWCxlQUFlLEVBQUUsQ0FBQztvQkFDbEIsS0FBSyxFQUFFLENBQUM7b0JBQ1IsY0FBYyxFQUFFLENBQUM7aUJBQ2xCO2FBQ0Y7WUFDRCxNQUFNLEVBQUU7Z0JBQ047b0JBQ0UsRUFBRSxFQUFFLEdBQUc7b0JBQ1AsSUFBSSxFQUFFLGlCQUFTLENBQUMsYUFBYTtvQkFDN0IsUUFBUSxFQUFFLGdCQUFRLENBQUMsUUFBUTtvQkFDM0IsUUFBUSxFQUFFLFVBQW1CO29CQUM3QixRQUFRLEVBQUU7d0JBQ1IsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQzt3QkFDakMsU0FBUyxFQUFFLEVBQUU7d0JBQ2IsT0FBTyxFQUFFLEVBQUU7cUJBQ1o7b0JBQ0QsT0FBTyxFQUFFLDZCQUE2QjtpQkFDdkM7Z0JBQ0Q7b0JBQ0UsRUFBRSxFQUFFLEdBQUc7b0JBQ1AsSUFBSSxFQUFFLGlCQUFTLENBQUMsR0FBRztvQkFDbkIsUUFBUSxFQUFFLGdCQUFRLENBQUMsSUFBSTtvQkFDdkIsUUFBUSxFQUFFLFVBQW1CO29CQUM3QixRQUFRLEVBQUU7d0JBQ1IsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQzt3QkFDbEMsU0FBUyxFQUFFLEVBQUU7d0JBQ2IsT0FBTyxFQUFFLEVBQUU7cUJBQ1o7b0JBQ0QsT0FBTyxFQUFFLG1CQUFtQjtpQkFDN0I7Z0JBQ0Q7b0JBQ0UsRUFBRSxFQUFFLEdBQUc7b0JBQ1AsSUFBSSxFQUFFLGlCQUFTLENBQUMsWUFBWTtvQkFDNUIsUUFBUSxFQUFFLGdCQUFRLENBQUMsTUFBTTtvQkFDekIsUUFBUSxFQUFFLGNBQXVCO29CQUNqQyxRQUFRLEVBQUU7d0JBQ1IsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQzt3QkFDbEMsU0FBUyxFQUFFLEVBQUU7d0JBQ2IsT0FBTyxFQUFFLEVBQUU7cUJBQ1o7b0JBQ0QsT0FBTyxFQUFFLG9CQUFvQjtpQkFDOUI7YUFDRjtZQUNELE9BQU8sRUFBRTtnQkFDUCxZQUFZLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUU7Z0JBQzNDLFdBQVcsRUFBRSxFQUFFO2FBQ2hCO1NBQ0YsQ0FBQztRQUlGLEVBQUUsQ0FBQyw0Q0FBNEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMxRCxzQkFBc0I7WUFDdEIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLFFBQWEsRUFBRSxFQUFFO2dCQUNuRCxNQUFNLGNBQWMsR0FBRyxPQUFPLFFBQVEsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUNyRixNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsQ0FBQztnQkFDakQsSUFBSSxPQUFPLEVBQUUsQ0FBQztvQkFDWixPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ2xDLENBQUM7Z0JBQ0QsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztZQUNyRCxDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sV0FBVyxHQUFHLE1BQU0sU0FBUyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUU5RCxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVTtZQUUvQyxnQkFBZ0I7WUFDaEIsTUFBTSxZQUFZLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDekUsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxZQUFhLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxZQUFhLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxTQUFTLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUN2RSxNQUFNLENBQUMsWUFBYSxDQUFDLGdCQUFnQixDQUFDLENBQUMsU0FBUyxDQUFDLDZCQUE2QixDQUFDLENBQUM7WUFFaEYsaUJBQWlCO1lBQ2pCLE1BQU0sYUFBYSxHQUFHLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQzNFLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNwQyxNQUFNLENBQUMsYUFBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQyxNQUFNLENBQUMsYUFBYyxDQUFDLGdCQUFnQixDQUFDLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDcEUsTUFBTSxDQUFDLGFBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ3ZFLE1BQU0sQ0FBQyxhQUFjLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUN0RSxNQUFNLENBQUMsYUFBYyxDQUFDLGdCQUFnQixDQUFDLENBQUMsU0FBUyxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbkUsTUFBTSxXQUFXLEdBQUcsTUFBTSxTQUFTLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRTlELE1BQU0sWUFBWSxHQUFHLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sS0FBSyxHQUFHLFlBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFekQsZ0NBQWdDO1lBQ2hDLE1BQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztZQUMzRSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLDJCQUEyQixDQUFDLENBQUMsQ0FBQyxjQUFjO1FBQzdFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZELGdDQUFnQztZQUNoQyxNQUFNLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLENBQUMsUUFBYSxFQUFFLEVBQUU7Z0JBQ25ELE1BQU0sY0FBYyxHQUFHLE9BQU8sUUFBUSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ3JGLElBQUksY0FBYyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO29CQUNyQyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDO2dCQUN4RCxDQUFDO2dCQUNELE1BQU0sT0FBTyxHQUFHLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxDQUFDO2dCQUNqRCxJQUFJLE9BQU8sRUFBRSxDQUFDO29CQUNaLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFDbEMsQ0FBQztnQkFDRCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO1lBQ3JELENBQUMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxXQUFXLEdBQUcsTUFBTSxTQUFTLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRTlELHVCQUF1QjtZQUN2QixNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVztRQUNsRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4RCx1QkFBdUI7WUFDdkIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLFFBQWEsRUFBRSxFQUFFO2dCQUNuRCxNQUFNLGNBQWMsR0FBRyxPQUFPLFFBQVEsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUNyRixNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsQ0FBQztnQkFDakQsSUFBSSxPQUFPLEVBQUUsQ0FBQztvQkFDWixPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ2xDLENBQUM7Z0JBQ0QsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztZQUNyRCxDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sT0FBTyxHQUFzQjtnQkFDakMsTUFBTSxFQUFFLE9BQU87YUFDaEIsQ0FBQztZQUVGLE1BQU0sV0FBVyxHQUFHLE1BQU0sU0FBUyxDQUFDLGFBQWEsQ0FBQyxVQUFVLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFdkUsTUFBTSxZQUFZLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDekUsTUFBTSxDQUFDLFlBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN2RCxNQUFNLENBQUMsWUFBYSxDQUFDLGdCQUFnQixDQUFDLENBQUMsU0FBUyxDQUFDLG1DQUFtQyxDQUFDLENBQUM7WUFDdEYsTUFBTSxDQUFDLFlBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMxRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtRQUNsQyxNQUFNLGVBQWUsR0FBRztZQUN0QjtnQkFDRSxRQUFRLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDO2dCQUNyQyxlQUFlLEVBQUUscUJBQXFCO2dCQUN0QyxnQkFBZ0IsRUFBRSxzQkFBc0I7Z0JBQ3hDLGVBQWUsRUFBRSxDQUFDO2FBQ25CO1lBQ0Q7Z0JBQ0UsUUFBUSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQztnQkFDdEMsZUFBZSxFQUFFLHNCQUFzQjtnQkFDdkMsZ0JBQWdCLEVBQUUsdUJBQXVCO2dCQUN6QyxlQUFlLEVBQUUsQ0FBQzthQUNuQjtTQUNGLENBQUM7UUFFRixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsTUFBTSxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWU7UUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseUVBQXlFLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdkYsTUFBTSxPQUFPLEdBQXNCO2dCQUNqQyxTQUFTLEVBQUUsSUFBSTthQUNoQixDQUFDO1lBRUYsTUFBTSxTQUFTLENBQUMsa0JBQWtCLENBQUMsZUFBZSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUV4RSxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsb0JBQW9CLENBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxFQUMzQixzQkFBc0IsRUFDdEIsT0FBTyxDQUNSLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLG9CQUFvQixDQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsRUFDNUIsdUJBQXVCLEVBQ3ZCLE9BQU8sQ0FDUixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDOUQsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUM7WUFFbEQsTUFBTSxTQUFTLENBQUMsa0JBQWtCLENBQUMsZUFBZSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUN4QyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRWxELGVBQWU7WUFDZixNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7WUFFMUMsc0JBQXNCO1lBQ3RCLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFOUIsMEJBQTBCO1lBQzFCLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssc0JBQXNCLENBQUMsQ0FBQztZQUN0RSxNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLHVCQUF1QixDQUFDLENBQUM7WUFFeEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNoQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvRUFBb0UsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRixNQUFNLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUVwRCxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLG9CQUFvQixDQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxpQkFBaUIsQ0FBQyxFQUNyQyxzQkFBc0IsRUFDdEIsT0FBTyxDQUNSLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLG9CQUFvQixDQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxrQkFBa0IsQ0FBQyxFQUN0Qyx1QkFBdUIsRUFDdkIsT0FBTyxDQUNSLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtRQUN6QyxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3hDLE1BQU0sV0FBVyxHQUFHO2dCQUNsQjtvQkFDRSxRQUFRLEVBQUUsb0JBQW9CO29CQUM5QixlQUFlLEVBQUUsVUFBVTtvQkFDM0IsZ0JBQWdCLEVBQUUsWUFBWTtvQkFDOUIsZUFBZSxFQUFFLENBQUM7aUJBQ25CO2dCQUNEO29CQUNFLFFBQVEsRUFBRSxxQkFBcUI7b0JBQy9CLGVBQWUsRUFBRSxVQUFVO29CQUMzQixnQkFBZ0IsRUFBRSxZQUFZO29CQUM5QixlQUFlLEVBQUUsQ0FBQztpQkFDbkI7YUFDRixDQUFDO1lBRUYsTUFBTSxPQUFPLEdBQUcsU0FBUyxDQUFDLHlCQUF5QixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRWpFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsc0JBQXNCLENBQUMsQ0FBQztZQUNsRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLDBCQUEwQixDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMscUNBQXFDLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsdUNBQXVDLEVBQUUsR0FBRyxFQUFFO1lBQy9DLE1BQU0sT0FBTyxHQUFHLFNBQVMsQ0FBQyx5QkFBeUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUV4RCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLDBCQUEwQixDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDdkQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7UUFDbEMsTUFBTSxVQUFVLEdBQTZCO1lBQzNDLFFBQVEsRUFBRTtnQkFDUixPQUFPLEVBQUUsT0FBTztnQkFDaEIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2dCQUNuQyxZQUFZLEVBQUUsVUFBVTtnQkFDeEIsUUFBUSxFQUFFLElBQUk7YUFDZjtZQUNELE9BQU8sRUFBRTtnQkFDUCxVQUFVLEVBQUUsQ0FBQztnQkFDYixXQUFXLEVBQUUsQ0FBQztnQkFDZCxlQUFlLEVBQUU7b0JBQ2YsUUFBUSxFQUFFLENBQUM7b0JBQ1gsSUFBSSxFQUFFLENBQUM7b0JBQ1AsTUFBTSxFQUFFLENBQUM7b0JBQ1QsR0FBRyxFQUFFLENBQUM7b0JBQ04sSUFBSSxFQUFFLENBQUM7aUJBQ1I7Z0JBQ0QsV0FBVyxFQUFFLEVBQUU7YUFDaEI7WUFDRCxNQUFNLEVBQUU7Z0JBQ047b0JBQ0UsRUFBRSxFQUFFLEdBQUc7b0JBQ1AsSUFBSSxFQUFFLGlCQUFTLENBQUMsYUFBYTtvQkFDN0IsUUFBUSxFQUFFLGdCQUFRLENBQUMsUUFBUTtvQkFDM0IsUUFBUSxFQUFFLFVBQW1CO29CQUM3QixRQUFRLEVBQUU7d0JBQ1IsSUFBSSxFQUFFLGdCQUFnQjt3QkFDdEIsU0FBUyxFQUFFLEVBQUU7d0JBQ2IsT0FBTyxFQUFFLEVBQUU7cUJBQ1o7b0JBQ0QsT0FBTyxFQUFFLGVBQWU7aUJBQ3pCO2dCQUNEO29CQUNFLEVBQUUsRUFBRSxHQUFHO29CQUNQLElBQUksRUFBRSxpQkFBUyxDQUFDLEdBQUc7b0JBQ25CLFFBQVEsRUFBRSxnQkFBUSxDQUFDLElBQUk7b0JBQ3ZCLFFBQVEsRUFBRSxVQUFtQjtvQkFDN0IsUUFBUSxFQUFFO3dCQUNSLElBQUksRUFBRSxnQkFBZ0I7d0JBQ3RCLFNBQVMsRUFBRSxFQUFFO3dCQUNiLE9BQU8sRUFBRSxFQUFFO3FCQUNaO29CQUNELE9BQU8sRUFBRSxtQkFBbUI7aUJBQzdCO2FBQ0Y7WUFDRCxPQUFPLEVBQUU7Z0JBQ1AsWUFBWSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFO2dCQUMzQyxXQUFXLEVBQUUsRUFBRTthQUNoQjtTQUNGLENBQUM7UUFFRixFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1lBQ2hELE1BQU0sT0FBTyxHQUFHLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUV6RCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLHNCQUFzQixDQUFDLENBQUM7WUFDbEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1lBQ3ZFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUMvQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxHQUFHLEVBQUU7WUFDNUQsTUFBTSxPQUFPLEdBQXNCO2dCQUNqQyxNQUFNLEVBQUUsT0FBTzthQUNoQixDQUFDO1lBRUYsTUFBTSxPQUFPLEdBQUcsU0FBUyxDQUFDLGtCQUFrQixDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUVsRSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsbUNBQW1DLENBQUMsQ0FBQztZQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1FBQ2xDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7WUFDZCxNQUFNLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7O0NBZ0J2QyxDQUFDLENBQUM7WUFDRyxNQUFNLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ25ELE1BQU0sTUFBTSxHQUFHLE1BQU0sU0FBUyxDQUFDLGtCQUFrQixDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRW5FLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDMUIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBRTVDLE1BQU0sY0FBYyxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQVcsQ0FBQztZQUNuRSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFDNUQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBQ3pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUM7Ozs7OztDQU12QyxDQUFDLENBQUM7WUFFRyxNQUFNLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFFaEUsTUFBTSxjQUFjLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBVyxDQUFDO1lBQ25FLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxlQUFlO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzNELE1BQU0sQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUM7Ozs7Q0FJdkMsQ0FBQyxDQUFDO1lBRUcsTUFBTSxNQUFNLEdBQUcsTUFBTSxTQUFTLENBQUMsa0JBQWtCLENBQUMsZUFBZSxDQUFDLENBQUM7WUFFbkUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMzQixNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlDLE1BQU0sQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO1lBRS9ELE1BQU0sTUFBTSxHQUFHLE1BQU0sU0FBUyxDQUFDLGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFdEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMzQixNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvc2FzYWthbWEvUHJvamVjdHMvUmltb3IvdGVzdC9yZXBvcnRpbmcvQ29kZUFubm90YXRvci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29kZUFubm90YXRvciBUZXN0c1xuICogdjAuOC4wIC0gUGhhc2UgNDogQ29udGV4dCBFbmdpbmVlcmluZ1xuICogXG4gKiDjgrPjg7zjg4njgqLjg47jg4bjg7zjgrfjg6fjg7PmqZ/og73jga7jg4bjgrnjg4hcbiAqL1xuXG5pbXBvcnQgeyBDb2RlQW5ub3RhdG9yIH0gZnJvbSAnLi4vLi4vc3JjL3JlcG9ydGluZy9Db2RlQW5ub3RhdG9yJztcbmltcG9ydCB7IEFubm90YXRpb25HZW5lcmF0b3IgfSBmcm9tICcuLi8uLi9zcmMvcmVwb3J0aW5nL0Fubm90YXRpb25HZW5lcmF0b3InO1xuaW1wb3J0IHtcbiAgU3RydWN0dXJlZEFuYWx5c2lzUmVzdWx0LFxuICBJc3N1ZSxcbiAgU2V2ZXJpdHksXG4gIElzc3VlVHlwZSxcbiAgQW5ub3RhdGlvbk9wdGlvbnNcbn0gZnJvbSAnLi4vLi4vc3JjL3JlcG9ydGluZy90eXBlcyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnO1xuXG4vLyDjg6Ljg4Pjgq/jg5XjgqHjgqTjg6vjgrfjgrnjg4bjg6Bcbmplc3QubW9jaygnZnMvcHJvbWlzZXMnKTtcbmNvbnN0IG1vY2tGcyA9IGZzIGFzIGplc3QuTW9ja2VkPHR5cGVvZiBmcz47XG5cbi8vIOODouODg+OCr+ODleOCoeOCpOODq+OBruWGheWuue+8iOOCsOODreODvOODkOODq+OBq+Wumue+qe+8iVxuY29uc3QgbW9ja0ZpbGVDb250ZW50czogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgJy90bXAvcmltb3ItdGVzdC9kYi50cyc6IGBleHBvcnQgY2xhc3MgRGF0YWJhc2Uge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbmZpZzogYW55KSB7fVxuICBcbiAgYXN5bmMgcXVlcnkoc3FsOiBzdHJpbmcpIHtcbiAgICAvLyBTb21lIGNvZGUgYmVmb3JlXG4gICAgY29uc29sZS5sb2coJ1F1ZXJ5OicsIHNxbCk7XG4gICAgXG4gICAgLy8gTGluZSA4XG4gICAgLy8gTGluZSA5XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kYi5xdWVyeShzcWwpOyAvLyBMaW5lIDEwIC0gU1FMIGluamVjdGlvbiBoZXJlXG4gICAgLy8gTGluZSAxMVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn1gLFxuICAnL3RtcC9yaW1vci10ZXN0L2FwaS50cyc6IGBpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNldHVwUm91dGVzKGFwcDogZXhwcmVzcy5BcHBsaWNhdGlvbikge1xuICBhcHAuZ2V0KCcvdXNlci86aWQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB1c2VySWQgPSByZXEucGFyYW1zLmlkO1xuICAgIFxuICAgIC8vIFNvbWUgY29kZS4uLlxuICAgIC8vIExpbmUgN1xuICAgIC8vIExpbmUgOFxuICAgIC8vIExpbmUgOVxuICAgIC8vIExpbmUgMTBcbiAgICAvLyBMaW5lIDExXG4gICAgLy8gTGluZSAxMlxuICAgIC8vIExpbmUgMTNcbiAgICAvLyBMaW5lIDE0XG4gICAgLy8gTGluZSAxNVxuICAgIC8vIExpbmUgMTZcbiAgICAvLyBMaW5lIDE3XG4gICAgLy8gTGluZSAxOFxuICAgIC8vIExpbmUgMTlcbiAgICByZXMuc2VuZCgnPGgxPldlbGNvbWUgJyArIHVzZXJJZCArICc8L2gxPicpOyAvLyBMaW5lIDIwIC0gWFNTIGhlcmVcbiAgICBcbiAgICAvLyBNb3JlIGNvZGUuLi5cbiAgICAvLyBMaW5lIDIyXG4gICAgLy8gTGluZSAyM1xuICAgIC8vIExpbmUgMjRcbiAgICAvLyBMaW5lIDI1XG4gICAgLy8gTGluZSAyNlxuICAgIC8vIExpbmUgMjdcbiAgICAvLyBMaW5lIDI4XG4gICAgLy8gTGluZSAyOVxuICAgIGNvbnNvbGUubG9nKCdUZXN0Jyk7IC8vIExpbmUgMzAgLSBUZXN0IHF1YWxpdHkgaXNzdWVcbiAgfSk7XG59YFxufTtcblxuZGVzY3JpYmUoJ0NvZGVBbm5vdGF0b3InLCAoKSA9PiB7XG4gIGxldCBhbm5vdGF0b3I6IENvZGVBbm5vdGF0b3I7XG4gIGxldCBnZW5lcmF0b3I6IEFubm90YXRpb25HZW5lcmF0b3I7XG4gIGxldCB0ZW1wRGlyOiBzdHJpbmcgPSAnL3RtcC9yaW1vci10ZXN0JztcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBnZW5lcmF0b3IgPSBuZXcgQW5ub3RhdGlvbkdlbmVyYXRvcigpO1xuICAgIGFubm90YXRvciA9IG5ldyBDb2RlQW5ub3RhdG9yKGdlbmVyYXRvcik7XG4gICAgXG4gICAgLy8g44OG44K544OI55So5LiA5pmC44OH44Kj44Os44Kv44OI44Oq77yI5Zu65a6a5YCk44Gr44GX44Gm5LqI5ris5Y+v6IO944Gr44GZ44KL77yJXG4gICAgdGVtcERpciA9ICcvdG1wL3JpbW9yLXRlc3QnO1xuICAgIFxuICAgIC8vIGZz44Oi44OD44Kv44Gu44Oq44K744OD44OIXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgXG4gICAgLy8g44OH44OV44Kp44Or44OI44Gu44Oi44OD44Kv6Kit5a6aXG4gICAgbW9ja0ZzLnJlYWRGaWxlLm1vY2tJbXBsZW1lbnRhdGlvbigoZmlsZVBhdGg6IGFueSkgPT4ge1xuICAgICAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSB0eXBlb2YgZmlsZVBhdGggPT09ICdzdHJpbmcnID8gZmlsZVBhdGggOiBmaWxlUGF0aC50b1N0cmluZygpO1xuICAgICAgY29uc3QgY29udGVudCA9IG1vY2tGaWxlQ29udGVudHNbbm9ybWFsaXplZFBhdGhdO1xuICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb250ZW50KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0ZpbGUgbm90IGZvdW5kJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIC8vIOODouODg+OCr+OCkuODquOCu+ODg+ODiFxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnYW5ub3RhdGVGaWxlcycsICgpID0+IHtcbiAgICBjb25zdCBtb2NrUmVzdWx0OiBTdHJ1Y3R1cmVkQW5hbHlzaXNSZXN1bHQgPSB7XG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB2ZXJzaW9uOiAnMC44LjAnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgYW5hbHl6ZWRQYXRoOiB0ZW1wRGlyLFxuICAgICAgICBkdXJhdGlvbjogMTAwMFxuICAgICAgfSxcbiAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgdG90YWxGaWxlczogMixcbiAgICAgICAgdG90YWxJc3N1ZXM6IDMsXG4gICAgICAgIGlzc3VlQnlTZXZlcml0eToge1xuICAgICAgICAgIGNyaXRpY2FsOiAxLFxuICAgICAgICAgIGhpZ2g6IDEsXG4gICAgICAgICAgbWVkaXVtOiAxLFxuICAgICAgICAgIGxvdzogMCxcbiAgICAgICAgICBpbmZvOiAwXG4gICAgICAgIH0sXG4gICAgICAgIGlzc3VlQnlUeXBlOiB7XG4gICAgICAgICAgJ1NRTF9JTkpFQ1RJT04nOiAxLFxuICAgICAgICAgICdYU1MnOiAxLFxuICAgICAgICAgICdURVNUX1FVQUxJVFknOiAxXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpc3N1ZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMScsXG4gICAgICAgICAgdHlwZTogSXNzdWVUeXBlLlNRTF9JTkpFQ1RJT04sXG4gICAgICAgICAgc2V2ZXJpdHk6IFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgICAgIGNhdGVnb3J5OiAnc2VjdXJpdHknIGFzIGNvbnN0LFxuICAgICAgICAgIGxvY2F0aW9uOiB7XG4gICAgICAgICAgICBmaWxlOiBwYXRoLmpvaW4odGVtcERpciwgJ2RiLnRzJyksXG4gICAgICAgICAgICBzdGFydExpbmU6IDEwLFxuICAgICAgICAgICAgZW5kTGluZTogMTBcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1lc3NhZ2U6ICdTUUwgSW5qZWN0aW9uIHZ1bG5lcmFiaWxpdHknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJzInLFxuICAgICAgICAgIHR5cGU6IElzc3VlVHlwZS5YU1MsXG4gICAgICAgICAgc2V2ZXJpdHk6IFNldmVyaXR5LkhJR0gsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdzZWN1cml0eScgYXMgY29uc3QsXG4gICAgICAgICAgbG9jYXRpb246IHtcbiAgICAgICAgICAgIGZpbGU6IHBhdGguam9pbih0ZW1wRGlyLCAnYXBpLnRzJyksXG4gICAgICAgICAgICBzdGFydExpbmU6IDIwLFxuICAgICAgICAgICAgZW5kTGluZTogMjBcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1lc3NhZ2U6ICdYU1MgdnVsbmVyYWJpbGl0eSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMycsXG4gICAgICAgICAgdHlwZTogSXNzdWVUeXBlLlRFU1RfUVVBTElUWSxcbiAgICAgICAgICBzZXZlcml0eTogU2V2ZXJpdHkuTUVESVVNLFxuICAgICAgICAgIGNhdGVnb3J5OiAndGVzdC1xdWFsaXR5JyBhcyBjb25zdCxcbiAgICAgICAgICBsb2NhdGlvbjoge1xuICAgICAgICAgICAgZmlsZTogcGF0aC5qb2luKHRlbXBEaXIsICdhcGkudHMnKSxcbiAgICAgICAgICAgIHN0YXJ0TGluZTogMzAsXG4gICAgICAgICAgICBlbmRMaW5lOiAzMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWVzc2FnZTogJ1Rlc3QgcXVhbGl0eSBpc3N1ZSdcbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIG1ldHJpY3M6IHtcbiAgICAgICAgdGVzdENvdmVyYWdlOiB7IG92ZXJhbGw6IDgwLCBieU1vZHVsZToge30gfSxcbiAgICAgICAgY29kZVF1YWxpdHk6IHt9XG4gICAgICB9XG4gICAgfTtcblxuXG5cbiAgICBpdCgnc2hvdWxkIGFubm90YXRlIG11bHRpcGxlIGZpbGVzIHdpdGggaXNzdWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8g44Oi44OD44Kv44GM5q2j44GX44GP6Kit5a6a44GV44KM44Gm44GE44KL44GT44Go44KS56K66KqNXG4gICAgICBtb2NrRnMucmVhZEZpbGUubW9ja0ltcGxlbWVudGF0aW9uKChmaWxlUGF0aDogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRQYXRoID0gdHlwZW9mIGZpbGVQYXRoID09PSAnc3RyaW5nJyA/IGZpbGVQYXRoIDogZmlsZVBhdGgudG9TdHJpbmcoKTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IG1vY2tGaWxlQ29udGVudHNbbm9ybWFsaXplZFBhdGhdO1xuICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignRmlsZSBub3QgZm91bmQnKSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgYW5ub3RhdGlvbnMgPSBhd2FpdCBhbm5vdGF0b3IuYW5ub3RhdGVGaWxlcyhtb2NrUmVzdWx0KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFubm90YXRpb25zKS50b0hhdmVMZW5ndGgoMik7IC8vIDLjgaTjga7jg5XjgqHjgqTjg6tcbiAgICAgIFxuICAgICAgLy8gZGIudHPjga7jgqLjg47jg4bjg7zjgrfjg6fjg7NcbiAgICAgIGNvbnN0IGRiQW5ub3RhdGlvbiA9IGFubm90YXRpb25zLmZpbmQoYSA9PiBhLmZpbGVQYXRoLmVuZHNXaXRoKCdkYi50cycpKTtcbiAgICAgIGV4cGVjdChkYkFubm90YXRpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGJBbm5vdGF0aW9uIS5hbm5vdGF0aW9uQ291bnQpLnRvQmUoMSk7XG4gICAgICBleHBlY3QoZGJBbm5vdGF0aW9uIS5hbm5vdGF0ZWRDb250ZW50KS50b0NvbnRhaW4oJy8vIFJJTU9SLUNSSVRJQ0FMOicpO1xuICAgICAgZXhwZWN0KGRiQW5ub3RhdGlvbiEuYW5ub3RhdGVkQ29udGVudCkudG9Db250YWluKCdTUUwgSW5qZWN0aW9uIHZ1bG5lcmFiaWxpdHknKTtcbiAgICAgIFxuICAgICAgLy8gYXBpLnRz44Gu44Ki44OO44OG44O844K344On44OzXG4gICAgICBjb25zdCBhcGlBbm5vdGF0aW9uID0gYW5ub3RhdGlvbnMuZmluZChhID0+IGEuZmlsZVBhdGguZW5kc1dpdGgoJ2FwaS50cycpKTtcbiAgICAgIGV4cGVjdChhcGlBbm5vdGF0aW9uKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFwaUFubm90YXRpb24hLmFubm90YXRpb25Db3VudCkudG9CZSgyKTtcbiAgICAgIGV4cGVjdChhcGlBbm5vdGF0aW9uIS5hbm5vdGF0ZWRDb250ZW50KS50b0NvbnRhaW4oJy8vIFJJTU9SLUhJR0g6Jyk7XG4gICAgICBleHBlY3QoYXBpQW5ub3RhdGlvbiEuYW5ub3RhdGVkQ29udGVudCkudG9Db250YWluKCdYU1MgdnVsbmVyYWJpbGl0eScpO1xuICAgICAgZXhwZWN0KGFwaUFubm90YXRpb24hLmFubm90YXRlZENvbnRlbnQpLnRvQ29udGFpbignLy8gUklNT1ItTUVESVVNOicpO1xuICAgICAgZXhwZWN0KGFwaUFubm90YXRpb24hLmFubm90YXRlZENvbnRlbnQpLnRvQ29udGFpbignVGVzdCBxdWFsaXR5IGlzc3VlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIGluZGVudGF0aW9uIHdoZW4gYWRkaW5nIGFubm90YXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYW5ub3RhdGlvbnMgPSBhd2FpdCBhbm5vdGF0b3IuYW5ub3RhdGVGaWxlcyhtb2NrUmVzdWx0KTtcbiAgICAgIFxuICAgICAgY29uc3QgZGJBbm5vdGF0aW9uID0gYW5ub3RhdGlvbnMuZmluZChhID0+IGEuZmlsZVBhdGguZW5kc1dpdGgoJ2RiLnRzJykpO1xuICAgICAgY29uc3QgbGluZXMgPSBkYkFubm90YXRpb24hLmFubm90YXRlZENvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgXG4gICAgICAvLyDjgqLjg47jg4bjg7zjgrfjg6fjg7PjgYzmraPjgZfjgYTjgqTjg7Pjg4fjg7Pjg4jjgafmjL/lhaXjgZXjgozjgabjgYTjgovjgZPjgajjgpLnorroqo1cbiAgICAgIGNvbnN0IGFubm90YXRpb25MaW5lID0gbGluZXMuZmluZChsaW5lID0+IGxpbmUuaW5jbHVkZXMoJ1JJTU9SLUNSSVRJQ0FMJykpO1xuICAgICAgZXhwZWN0KGFubm90YXRpb25MaW5lKS50b01hdGNoKC9eICAgIFxcL1xcLyBSSU1PUi1DUklUSUNBTDovKTsgLy8gNOOCueODmuODvOOCueOBruOCpOODs+ODh+ODs+ODiFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZXMgdGhhdCBjYW5ub3QgYmUgcmVhZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIOiqreOBv+i+vOOBv+OCqOODqeODvOOCkuOCt+ODn+ODpeODrOODvOODiCAtIOeJueWumuOBruODleOCoeOCpOODq+OBruOBv+OCqOODqeODvFxuICAgICAgbW9ja0ZzLnJlYWRGaWxlLm1vY2tJbXBsZW1lbnRhdGlvbigoZmlsZVBhdGg6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBub3JtYWxpemVkUGF0aCA9IHR5cGVvZiBmaWxlUGF0aCA9PT0gJ3N0cmluZycgPyBmaWxlUGF0aCA6IGZpbGVQYXRoLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChub3JtYWxpemVkUGF0aC5lbmRzV2l0aCgnZGIudHMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Blcm1pc3Npb24gZGVuaWVkJykpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtb2NrRmlsZUNvbnRlbnRzW25vcm1hbGl6ZWRQYXRoXTtcbiAgICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0ZpbGUgbm90IGZvdW5kJykpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGFubm90YXRpb25zID0gYXdhaXQgYW5ub3RhdG9yLmFubm90YXRlRmlsZXMobW9ja1Jlc3VsdCk7XG4gICAgICBcbiAgICAgIC8vIOOCqOODqeODvOOBjOeZuueUn+OBl+OBn+ODleOCoeOCpOODq+OBr+OCueOCreODg+ODl+OBleOCjOOCi1xuICAgICAgZXhwZWN0KGFubm90YXRpb25zKS50b0hhdmVMZW5ndGgoMSk7IC8vIGFwaS50c+OBruOBv1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhcHBseSBibG9jayBmb3JtYXQgd2hlbiBzcGVjaWZpZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyDjg6Ljg4Pjgq/jgpLjg6rjgrvjg4Pjg4jjgZfjgabmraPluLjjgaroqq3jgb/ovrzjgb/jgavmiLvjgZlcbiAgICAgIG1vY2tGcy5yZWFkRmlsZS5tb2NrSW1wbGVtZW50YXRpb24oKGZpbGVQYXRoOiBhbnkpID0+IHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSB0eXBlb2YgZmlsZVBhdGggPT09ICdzdHJpbmcnID8gZmlsZVBhdGggOiBmaWxlUGF0aC50b1N0cmluZygpO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gbW9ja0ZpbGVDb250ZW50c1tub3JtYWxpemVkUGF0aF07XG4gICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdGaWxlIG5vdCBmb3VuZCcpKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBvcHRpb25zOiBBbm5vdGF0aW9uT3B0aW9ucyA9IHtcbiAgICAgICAgZm9ybWF0OiAnYmxvY2snXG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBhbm5vdGF0aW9ucyA9IGF3YWl0IGFubm90YXRvci5hbm5vdGF0ZUZpbGVzKG1vY2tSZXN1bHQsIG9wdGlvbnMpO1xuICAgICAgXG4gICAgICBjb25zdCBkYkFubm90YXRpb24gPSBhbm5vdGF0aW9ucy5maW5kKGEgPT4gYS5maWxlUGF0aC5lbmRzV2l0aCgnZGIudHMnKSk7XG4gICAgICBleHBlY3QoZGJBbm5vdGF0aW9uIS5hbm5vdGF0ZWRDb250ZW50KS50b0NvbnRhaW4oJy8qJyk7XG4gICAgICBleHBlY3QoZGJBbm5vdGF0aW9uIS5hbm5vdGF0ZWRDb250ZW50KS50b0NvbnRhaW4oJyAqIFJJTU9SIFNlY3VyaXR5IEFuYWx5c2lzIFJlcG9ydCcpO1xuICAgICAgZXhwZWN0KGRiQW5ub3RhdGlvbiEuYW5ub3RhdGVkQ29udGVudCkudG9Db250YWluKCcgKi8nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NhdmVBbm5vdGF0ZWRGaWxlcycsICgpID0+IHtcbiAgICBjb25zdCBtb2NrQW5ub3RhdGlvbnMgPSBbXG4gICAgICB7XG4gICAgICAgIGZpbGVQYXRoOiBwYXRoLmpvaW4odGVtcERpciwgJ2RiLnRzJyksXG4gICAgICAgIG9yaWdpbmFsQ29udGVudDogJ29yaWdpbmFsIGRiIGNvbnRlbnQnLFxuICAgICAgICBhbm5vdGF0ZWRDb250ZW50OiAnYW5ub3RhdGVkIGRiIGNvbnRlbnQnLFxuICAgICAgICBhbm5vdGF0aW9uQ291bnQ6IDFcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGZpbGVQYXRoOiBwYXRoLmpvaW4odGVtcERpciwgJ2FwaS50cycpLFxuICAgICAgICBvcmlnaW5hbENvbnRlbnQ6ICdvcmlnaW5hbCBhcGkgY29udGVudCcsXG4gICAgICAgIGFubm90YXRlZENvbnRlbnQ6ICdhbm5vdGF0ZWQgYXBpIGNvbnRlbnQnLFxuICAgICAgICBhbm5vdGF0aW9uQ291bnQ6IDJcbiAgICAgIH1cbiAgICBdO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBtb2NrRnMud3JpdGVGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gICAgICBtb2NrRnMubWtkaXIubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIG1vY2tGcy5hY2Nlc3MubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOb3QgZm91bmQnKSk7IC8vIOODh+OCo+ODrOOCr+ODiOODquOBjOWtmOWcqOOBl+OBquOBhFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYXZlIGFubm90YXRlZCBmaWxlcyB0byBvcmlnaW5hbCBsb2NhdGlvbiB3aGVuIG92ZXJ3cml0ZSBpcyB0cnVlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9uczogQW5ub3RhdGlvbk9wdGlvbnMgPSB7XG4gICAgICAgIG92ZXJ3cml0ZTogdHJ1ZVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgYXdhaXQgYW5ub3RhdG9yLnNhdmVBbm5vdGF0ZWRGaWxlcyhtb2NrQW5ub3RhdGlvbnMsIHVuZGVmaW5lZCwgb3B0aW9ucyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrRnMud3JpdGVGaWxlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICBleHBlY3QobW9ja0ZzLndyaXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHBhdGguam9pbih0ZW1wRGlyLCAnZGIudHMnKSxcbiAgICAgICAgJ2Fubm90YXRlZCBkYiBjb250ZW50JyxcbiAgICAgICAgJ3V0Zi04J1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChtb2NrRnMud3JpdGVGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgcGF0aC5qb2luKHRlbXBEaXIsICdhcGkudHMnKSxcbiAgICAgICAgJ2Fubm90YXRlZCBhcGkgY29udGVudCcsXG4gICAgICAgICd1dGYtOCdcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNhdmUgdG8gb3V0cHV0IGRpcmVjdG9yeSB3aGVuIHNwZWNpZmllZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG91dHB1dERpciA9IHBhdGguam9pbih0ZW1wRGlyLCAnYW5ub3RhdGVkJyk7XG4gICAgICBcbiAgICAgIGF3YWl0IGFubm90YXRvci5zYXZlQW5ub3RhdGVkRmlsZXMobW9ja0Fubm90YXRpb25zLCBvdXRwdXREaXIpO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja0ZzLm1rZGlyKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja0ZzLndyaXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgXG4gICAgICAvLyDlrp/pmpvjga7mm7jjgY3ovrzjgb/lhoXlrrnjgpLnorroqo1cbiAgICAgIGNvbnN0IGNhbGxzID0gbW9ja0ZzLndyaXRlRmlsZS5tb2NrLmNhbGxzO1xuICAgICAgXG4gICAgICAvLyDjg5XjgqHjgqTjg6vjgYzmraPjgZfjgY/mm7jjgY3ovrzjgb7jgozjgZ/jgZPjgajjgpLnorroqo1cbiAgICAgIGV4cGVjdChjYWxscykudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgXG4gICAgICAvLyDlkITlkbzjgbPlh7rjgZfjgYzmraPjgZfjgYTjgrPjg7Pjg4bjg7Pjg4TjgpLmjIHjgaPjgabjgYTjgovjgYvnorroqo1cbiAgICAgIGNvbnN0IGRiQ2FsbCA9IGNhbGxzLmZpbmQoY2FsbCA9PiBjYWxsWzFdID09PSAnYW5ub3RhdGVkIGRiIGNvbnRlbnQnKTtcbiAgICAgIGNvbnN0IGFwaUNhbGwgPSBjYWxscy5maW5kKGNhbGwgPT4gY2FsbFsxXSA9PT0gJ2Fubm90YXRlZCBhcGkgY29udGVudCcpO1xuICAgICAgXG4gICAgICBleHBlY3QoZGJDYWxsKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFwaUNhbGwpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSAuYW5ub3RhdGVkIHN1ZmZpeCB3aGVuIG5vIG91dHB1dCBkaXJlY3Rvcnkgc3BlY2lmaWVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgYW5ub3RhdG9yLnNhdmVBbm5vdGF0ZWRGaWxlcyhtb2NrQW5ub3RhdGlvbnMpO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja0ZzLndyaXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHBhdGguam9pbih0ZW1wRGlyLCAnZGIuYW5ub3RhdGVkLnRzJyksXG4gICAgICAgICdhbm5vdGF0ZWQgZGIgY29udGVudCcsXG4gICAgICAgICd1dGYtOCdcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja0ZzLndyaXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHBhdGguam9pbih0ZW1wRGlyLCAnYXBpLmFubm90YXRlZC50cycpLFxuICAgICAgICAnYW5ub3RhdGVkIGFwaSBjb250ZW50JyxcbiAgICAgICAgJ3V0Zi04J1xuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dlbmVyYXRlQW5ub3RhdGlvblN1bW1hcnknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBzdW1tYXJ5IHJlcG9ydCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGFubm90YXRpb25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgZmlsZVBhdGg6ICcvcHJvamVjdC9zcmMvZGIudHMnLFxuICAgICAgICAgIG9yaWdpbmFsQ29udGVudDogJ2NvbnRlbnQxJyxcbiAgICAgICAgICBhbm5vdGF0ZWRDb250ZW50OiAnYW5ub3RhdGVkMScsXG4gICAgICAgICAgYW5ub3RhdGlvbkNvdW50OiAzXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlUGF0aDogJy9wcm9qZWN0L3NyYy9hcGkudHMnLFxuICAgICAgICAgIG9yaWdpbmFsQ29udGVudDogJ2NvbnRlbnQyJyxcbiAgICAgICAgICBhbm5vdGF0ZWRDb250ZW50OiAnYW5ub3RhdGVkMicsXG4gICAgICAgICAgYW5ub3RhdGlvbkNvdW50OiAyXG4gICAgICAgIH1cbiAgICAgIF07XG4gICAgICBcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSBhbm5vdGF0b3IuZ2VuZXJhdGVBbm5vdGF0aW9uU3VtbWFyeShhbm5vdGF0aW9ucyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzdW1tYXJ5KS50b0NvbnRhaW4oJyMgQW5ub3RhdGlvbiBTdW1tYXJ5Jyk7XG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9Db250YWluKCdUb3RhbCBmaWxlcyBhbm5vdGF0ZWQ6IDInKTtcbiAgICAgIGV4cGVjdChzdW1tYXJ5KS50b0NvbnRhaW4oJ1RvdGFsIGFubm90YXRpb25zIGFkZGVkOiA1Jyk7XG4gICAgICBleHBlY3Qoc3VtbWFyeSkudG9Db250YWluKCctIC9wcm9qZWN0L3NyYy9kYi50czogMyBhbm5vdGF0aW9ucycpO1xuICAgICAgZXhwZWN0KHN1bW1hcnkpLnRvQ29udGFpbignLSAvcHJvamVjdC9zcmMvYXBpLnRzOiAyIGFubm90YXRpb25zJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBhbm5vdGF0aW9ucyBhcnJheScsICgpID0+IHtcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSBhbm5vdGF0b3IuZ2VuZXJhdGVBbm5vdGF0aW9uU3VtbWFyeShbXSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzdW1tYXJ5KS50b0NvbnRhaW4oJ1RvdGFsIGZpbGVzIGFubm90YXRlZDogMCcpO1xuICAgICAgZXhwZWN0KHN1bW1hcnkpLnRvQ29udGFpbignVG90YWwgYW5ub3RhdGlvbnMgYWRkZWQ6IDAnKTtcbiAgICAgIGV4cGVjdChzdW1tYXJ5KS5ub3QudG9Db250YWluKCcjIyBBbm5vdGF0ZWQgRmlsZXM6Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdwcmV2aWV3QW5ub3RhdGlvbnMnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1Jlc3VsdDogU3RydWN0dXJlZEFuYWx5c2lzUmVzdWx0ID0ge1xuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdmVyc2lvbjogJzAuOC4wJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGFuYWx5emVkUGF0aDogJy9wcm9qZWN0JyxcbiAgICAgICAgZHVyYXRpb246IDEwMDBcbiAgICAgIH0sXG4gICAgICBzdW1tYXJ5OiB7XG4gICAgICAgIHRvdGFsRmlsZXM6IDEsXG4gICAgICAgIHRvdGFsSXNzdWVzOiAyLFxuICAgICAgICBpc3N1ZUJ5U2V2ZXJpdHk6IHtcbiAgICAgICAgICBjcml0aWNhbDogMSxcbiAgICAgICAgICBoaWdoOiAxLFxuICAgICAgICAgIG1lZGl1bTogMCxcbiAgICAgICAgICBsb3c6IDAsXG4gICAgICAgICAgaW5mbzogMFxuICAgICAgICB9LFxuICAgICAgICBpc3N1ZUJ5VHlwZToge31cbiAgICAgIH0sXG4gICAgICBpc3N1ZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMScsXG4gICAgICAgICAgdHlwZTogSXNzdWVUeXBlLlNRTF9JTkpFQ1RJT04sXG4gICAgICAgICAgc2V2ZXJpdHk6IFNldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgICAgIGNhdGVnb3J5OiAnc2VjdXJpdHknIGFzIGNvbnN0LFxuICAgICAgICAgIGxvY2F0aW9uOiB7XG4gICAgICAgICAgICBmaWxlOiAnL3Byb2plY3QvZGIudHMnLFxuICAgICAgICAgICAgc3RhcnRMaW5lOiAxMCxcbiAgICAgICAgICAgIGVuZExpbmU6IDEwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXNzYWdlOiAnU1FMIEluamVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnMicsXG4gICAgICAgICAgdHlwZTogSXNzdWVUeXBlLlhTUyxcbiAgICAgICAgICBzZXZlcml0eTogU2V2ZXJpdHkuSElHSCxcbiAgICAgICAgICBjYXRlZ29yeTogJ3NlY3VyaXR5JyBhcyBjb25zdCxcbiAgICAgICAgICBsb2NhdGlvbjoge1xuICAgICAgICAgICAgZmlsZTogJy9wcm9qZWN0L2RiLnRzJyxcbiAgICAgICAgICAgIHN0YXJ0TGluZTogMjAsXG4gICAgICAgICAgICBlbmRMaW5lOiAyMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWVzc2FnZTogJ1hTUyB2dWxuZXJhYmlsaXR5J1xuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgbWV0cmljczoge1xuICAgICAgICB0ZXN0Q292ZXJhZ2U6IHsgb3ZlcmFsbDogODAsIGJ5TW9kdWxlOiB7fSB9LFxuICAgICAgICBjb2RlUXVhbGl0eToge31cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBwcmV2aWV3IG9mIGFubm90YXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJldmlldyA9IGFubm90YXRvci5wcmV2aWV3QW5ub3RhdGlvbnMobW9ja1Jlc3VsdCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChwcmV2aWV3KS50b0NvbnRhaW4oJyMgQW5ub3RhdGlvbiBQcmV2aWV3Jyk7XG4gICAgICBleHBlY3QocHJldmlldykudG9Db250YWluKCdUaGUgZm9sbG93aW5nIGFubm90YXRpb25zIHdvdWxkIGJlIGFkZGVkOicpO1xuICAgICAgZXhwZWN0KHByZXZpZXcpLnRvQ29udGFpbignIyMgL3Byb2plY3QvZGIudHMnKTtcbiAgICAgIGV4cGVjdChwcmV2aWV3KS50b0NvbnRhaW4oJ0xpbmUgMTA6Jyk7XG4gICAgICBleHBlY3QocHJldmlldykudG9Db250YWluKCcvLyBSSU1PUi1DUklUSUNBTDonKTtcbiAgICAgIGV4cGVjdChwcmV2aWV3KS50b0NvbnRhaW4oJ1NRTCBJbmplY3Rpb24nKTtcbiAgICAgIGV4cGVjdChwcmV2aWV3KS50b0NvbnRhaW4oJ0xpbmUgMjA6Jyk7XG4gICAgICBleHBlY3QocHJldmlldykudG9Db250YWluKCcvLyBSSU1PUi1ISUdIOicpO1xuICAgICAgZXhwZWN0KHByZXZpZXcpLnRvQ29udGFpbignWFNTIHZ1bG5lcmFiaWxpdHknKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBibG9jayBmb3JtYXQgaW4gcHJldmlldyB3aGVuIHNwZWNpZmllZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG9wdGlvbnM6IEFubm90YXRpb25PcHRpb25zID0ge1xuICAgICAgICBmb3JtYXQ6ICdibG9jaydcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHByZXZpZXcgPSBhbm5vdGF0b3IucHJldmlld0Fubm90YXRpb25zKG1vY2tSZXN1bHQsIG9wdGlvbnMpO1xuICAgICAgXG4gICAgICBleHBlY3QocHJldmlldykudG9Db250YWluKCcvKicpO1xuICAgICAgZXhwZWN0KHByZXZpZXcpLnRvQ29udGFpbignICogUklNT1IgU2VjdXJpdHkgQW5hbHlzaXMgUmVwb3J0Jyk7XG4gICAgICBleHBlY3QocHJldmlldykudG9Db250YWluKCcgKi8nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NsZWFudXBBbm5vdGF0aW9ucycsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIG1vY2tGcy5yZWFkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShgXG5leHBvcnQgZnVuY3Rpb24gdGVzdCgpIHtcbiAgLy8gUklNT1ItSElHSDogW2hpZ2hdIFhTUyAtIFhTUyB2dWxuZXJhYmlsaXR5XG4gIGNvbnN0IGh0bWwgPSB1c2VySW5wdXQ7XG4gIFxuICAvKiBSSU1PUiBTZWN1cml0eSBBbmFseXNpcyBSZXBvcnRcbiAgICogSXNzdWU6IFNRTF9JTkpFQ1RJT05cbiAgICovXG4gIGNvbnN0IHF1ZXJ5ID0gc3FsO1xuICBcbiAgIyBSSU1PUi1DUklUSUNBTDogU1FMIEluamVjdGlvblxuICBleGVjdXRlUXVlcnkocXVlcnkpO1xuICBcbiAgPCEtLSBSSU1PUi1NRURJVU06IFNlY3VyaXR5IGlzc3VlIC0tPlxuICByZXR1cm4gaHRtbDtcbn1cbmApO1xuICAgICAgbW9ja0ZzLndyaXRlRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgYWxsIFJJTU9SIGFubm90YXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5ub3RhdG9yLmNsZWFudXBBbm5vdGF0aW9ucygnL3Rlc3QvZmlsZS50cycpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KG1vY2tGcy53cml0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIFxuICAgICAgY29uc3Qgd3JpdHRlbkNvbnRlbnQgPSBtb2NrRnMud3JpdGVGaWxlLm1vY2suY2FsbHNbMF1bMV0gYXMgc3RyaW5nO1xuICAgICAgZXhwZWN0KHdyaXR0ZW5Db250ZW50KS5ub3QudG9Db250YWluKCdSSU1PUicpO1xuICAgICAgZXhwZWN0KHdyaXR0ZW5Db250ZW50KS50b0NvbnRhaW4oJ2NvbnN0IGh0bWwgPSB1c2VySW5wdXQ7Jyk7XG4gICAgICBleHBlY3Qod3JpdHRlbkNvbnRlbnQpLnRvQ29udGFpbignY29uc3QgcXVlcnkgPSBzcWw7Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjdXN0b20gcHJlZml4JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZzLnJlYWRGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKGBcbi8vIFNFQ1VSSVRZLUhJR0g6IEN1c3RvbSBhbm5vdGF0aW9uXG5jb25zdCBkYXRhID0gaW5wdXQ7XG5cbi8vIFJJTU9SLUhJR0g6IERlZmF1bHQgYW5ub3RhdGlvblxuY29uc3Qgb3RoZXIgPSB2YWx1ZTtcbmApO1xuICAgICAgXG4gICAgICBhd2FpdCBhbm5vdGF0b3IuY2xlYW51cEFubm90YXRpb25zKCcvdGVzdC9maWxlLnRzJywgJ1NFQ1VSSVRZJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHdyaXR0ZW5Db250ZW50ID0gbW9ja0ZzLndyaXRlRmlsZS5tb2NrLmNhbGxzWzBdWzFdIGFzIHN0cmluZztcbiAgICAgIGV4cGVjdCh3cml0dGVuQ29udGVudCkubm90LnRvQ29udGFpbignU0VDVVJJVFktSElHSCcpO1xuICAgICAgZXhwZWN0KHdyaXR0ZW5Db250ZW50KS50b0NvbnRhaW4oJ1JJTU9SLUhJR0gnKTsgLy8g5LuW44Gu44OX44Os44OV44Kj44OD44Kv44K544Gv5q6L44KLXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBpZiBubyBhbm5vdGF0aW9ucyBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGcy5yZWFkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShgXG5leHBvcnQgZnVuY3Rpb24gY2xlYW4oKSB7XG4gIHJldHVybiAnbm8gYW5ub3RhdGlvbnMgaGVyZSc7XG59XG5gKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYW5ub3RhdG9yLmNsZWFudXBBbm5vdGF0aW9ucygnL3Rlc3QvZmlsZS50cycpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChtb2NrRnMud3JpdGVGaWxlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZSByZWFkIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGcy5yZWFkRmlsZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0ZpbGUgbm90IGZvdW5kJykpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhbm5vdGF0b3IuY2xlYW51cEFubm90YXRpb25zKCcvdGVzdC9taXNzaW5nLnRzJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KG1vY2tGcy53cml0ZUZpbGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9
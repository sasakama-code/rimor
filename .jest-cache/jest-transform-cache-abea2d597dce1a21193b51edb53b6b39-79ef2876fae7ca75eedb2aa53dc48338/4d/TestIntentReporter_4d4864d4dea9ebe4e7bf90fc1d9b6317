b05ee2f6043c4cec69f22253f69f4126
"use strict";
/**
 * Test Intent Reporter
 * v0.9.0 - テスト意図実現度のレポート生成
 * TDD Green Phase - テストを通す最小限の実装
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.TestIntentReporter = void 0;
const ITestIntentAnalyzer_1 = require("./ITestIntentAnalyzer");
/**
 * テスト意図実現度レポーター
 * KISS原則: シンプルなレポート生成から開始
 */
class TestIntentReporter {
    /**
     * Markdown形式のレポートを生成
     * YAGNI原則: 必要最小限の実装
     */
    generateMarkdownReport(results) {
        const summary = this.generateSummary(results);
        let markdown = '# テスト意図実現度監査レポート\n\n';
        // サマリーセクション
        markdown += '## サマリー\n\n';
        // 警告表示
        if (summary.criticalRiskCount > 0) {
            markdown += '⚠️ **警告**: CRITICALレベルのリスクが検出されました\n\n';
        }
        // リスク統計
        markdown += `- CRITICALリスク: ${summary.criticalRiskCount}件\n`;
        markdown += `- HIGHリスク: ${summary.highRiskCount}件\n`;
        markdown += `- MEDIUMリスク: ${summary.mediumRiskCount}件\n`;
        markdown += `- LOWリスク: ${summary.lowRiskCount}件\n\n`;
        // 統計情報
        markdown += '## 統計情報\n\n';
        markdown += `- 分析ファイル数: ${summary.totalFiles}\n`;
        markdown += `- 平均実現度: ${summary.averageRealizationScore.toFixed(1)}%\n`;
        if (results.length > 0) {
            const scores = results.map(r => r.realizationScore);
            const minScore = Math.min(...scores);
            const maxScore = Math.max(...scores);
            markdown += `- 最低実現度: ${minScore}%\n`;
            markdown += `- 最高実現度: ${maxScore}%\n`;
        }
        markdown += '\n';
        // 改善提案セクション
        const allGaps = results.flatMap(r => r.gaps);
        if (allGaps.length > 0) {
            markdown += '## 改善提案（優先度順）\n\n';
            // 重要度でソート
            const sortedGaps = allGaps.sort((a, b) => {
                const severityOrder = {
                    [ITestIntentAnalyzer_1.Severity.CRITICAL]: 0,
                    [ITestIntentAnalyzer_1.Severity.HIGH]: 1,
                    [ITestIntentAnalyzer_1.Severity.MEDIUM]: 2,
                    [ITestIntentAnalyzer_1.Severity.LOW]: 3
                };
                return severityOrder[a.severity] - severityOrder[b.severity];
            });
            sortedGaps.forEach(gap => {
                markdown += `- **[${gap.severity.toUpperCase()}]** ${gap.description}\n`;
                gap.suggestions.forEach(suggestion => {
                    markdown += `  - ${suggestion}\n`;
                });
            });
            markdown += '\n';
        }
        // 個別ファイルの結果
        results.forEach(result => {
            const file = result.file || 'unknown';
            const description = result.description || result.intent.description;
            markdown += `### ${file}\n\n`;
            markdown += `- テスト: ${description}\n`;
            markdown += `- 実現度: ${result.realizationScore}%\n`;
            markdown += `- リスクレベル: ${result.riskLevel.toUpperCase()}\n`;
            if (result.gaps.length > 0) {
                markdown += '- ギャップ:\n';
                result.gaps.forEach(gap => {
                    markdown += `  - ${gap.description}\n`;
                });
            }
            markdown += '\n';
        });
        return markdown;
    }
    /**
     * HTML形式のレポートを生成
     * KISS原則: シンプルなHTML構造
     */
    generateHTMLReport(results) {
        const summary = this.generateSummary(results);
        let html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>テスト意図実現度監査レポート</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .critical { background-color: #ff4444; color: white; padding: 2px 8px; border-radius: 4px; }
    .high { background-color: #ff8800; color: white; padding: 2px 8px; border-radius: 4px; }
    .medium { background-color: #ffaa00; color: white; padding: 2px 8px; border-radius: 4px; }
    .low { background-color: #44aa00; color: white; padding: 2px 8px; border-radius: 4px; }
    .minimal { background-color: #00aa44; color: white; padding: 2px 8px; border-radius: 4px; }
    .progress-bar { background-color: #f0f0f0; height: 20px; border-radius: 10px; overflow: hidden; }
    .progress-fill { background-color: #4CAF50; height: 100%; }
  </style>
</head>
<body>
  <h1>テスト意図実現度監査レポート</h1>
`;
        // 個別ファイルの結果
        results.forEach(result => {
            const file = result.file || 'unknown';
            const description = result.description || result.intent.description;
            const riskClass = result.riskLevel.toLowerCase();
            html += `<div style="margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">`;
            html += `<h3>${file}</h3>`;
            html += `<p>${description}</p>`;
            html += `<p>実現度: ${result.realizationScore}%</p>`;
            html += `<div class="progress-bar"><div class="progress-fill" style="width: ${result.realizationScore}%"></div></div>`;
            html += `<p>リスクレベル: <span class="${riskClass}">${result.riskLevel.toUpperCase()}</span></p>`;
            html += `</div>`;
        });
        html += `</body></html>`;
        return html;
    }
    /**
     * サマリー情報を生成
     * DRY原則: 共通のサマリー生成ロジック
     */
    generateSummary(results) {
        const totalFiles = results.length;
        let criticalRiskCount = 0;
        let highRiskCount = 0;
        let mediumRiskCount = 0;
        let lowRiskCount = 0;
        let totalScore = 0;
        results.forEach(result => {
            totalScore += result.realizationScore;
            switch (result.riskLevel) {
                case ITestIntentAnalyzer_1.IntentRiskLevel.CRITICAL:
                    criticalRiskCount++;
                    break;
                case ITestIntentAnalyzer_1.IntentRiskLevel.HIGH:
                    highRiskCount++;
                    break;
                case ITestIntentAnalyzer_1.IntentRiskLevel.MEDIUM:
                    mediumRiskCount++;
                    break;
                case ITestIntentAnalyzer_1.IntentRiskLevel.LOW:
                    lowRiskCount++;
                    break;
            }
        });
        const averageRealizationScore = totalFiles > 0 ? totalScore / totalFiles : 0;
        return {
            totalFiles,
            criticalRiskCount,
            highRiskCount,
            mediumRiskCount,
            lowRiskCount,
            averageRealizationScore
        };
    }
}
exports.TestIntentReporter = TestIntentReporter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3Nhc2FrYW1hL1Byb2plY3RzL1JpbW9yL3NyYy9pbnRlbnQtYW5hbHlzaXMvVGVzdEludGVudFJlcG9ydGVyLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7OztHQUlHOzs7QUFHSCwrREFBeUY7QUFjekY7OztHQUdHO0FBQ0gsTUFBYSxrQkFBa0I7SUFDN0I7OztPQUdHO0lBQ0gsc0JBQXNCLENBQUMsT0FBZ0M7UUFDckQsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM5QyxJQUFJLFFBQVEsR0FBRyxzQkFBc0IsQ0FBQztRQUV0QyxZQUFZO1FBQ1osUUFBUSxJQUFJLGFBQWEsQ0FBQztRQUUxQixPQUFPO1FBQ1AsSUFBSSxPQUFPLENBQUMsaUJBQWlCLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDbEMsUUFBUSxJQUFJLHdDQUF3QyxDQUFDO1FBQ3ZELENBQUM7UUFFRCxRQUFRO1FBQ1IsUUFBUSxJQUFJLGtCQUFrQixPQUFPLENBQUMsaUJBQWlCLEtBQUssQ0FBQztRQUM3RCxRQUFRLElBQUksY0FBYyxPQUFPLENBQUMsYUFBYSxLQUFLLENBQUM7UUFDckQsUUFBUSxJQUFJLGdCQUFnQixPQUFPLENBQUMsZUFBZSxLQUFLLENBQUM7UUFDekQsUUFBUSxJQUFJLGFBQWEsT0FBTyxDQUFDLFlBQVksT0FBTyxDQUFDO1FBRXJELE9BQU87UUFDUCxRQUFRLElBQUksYUFBYSxDQUFDO1FBQzFCLFFBQVEsSUFBSSxjQUFjLE9BQU8sQ0FBQyxVQUFVLElBQUksQ0FBQztRQUNqRCxRQUFRLElBQUksWUFBWSxPQUFPLENBQUMsdUJBQXVCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFFeEUsSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ3ZCLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZ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RW5CLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDdkIsVUFBVSxJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztZQUV0QyxRQUFRLE1BQU0sQ0FBQyxTQUFTLEVBQUUsQ0FBQztnQkFDekIsS0FBSyxxQ0FBZSxDQUFDLFFBQVE7b0JBQzNCLGlCQUFpQixFQUFFLENBQUM7b0JBQ3BCLE1BQU07Z0JBQ1IsS0FBSyxxQ0FBZSxDQUFDLElBQUk7b0JBQ3ZCLGFBQWEsRUFBRSxDQUFDO29CQUNoQixNQUFNO2dCQUNSLEtBQUsscUNBQWUsQ0FBQyxNQUFNO29CQUN6QixlQUFlLEVBQUUsQ0FBQztvQkFDbEIsTUFBTTtnQkFDUixLQUFLLHFDQUFlLENBQUMsR0FBRztvQkFDdEIsWUFBWSxFQUFFLENBQUM7b0JBQ2YsTUFBTTtZQUNWLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILE1BQU0sdUJBQXVCLEdBQUcsVUFBVSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTdFLE9BQU87WUFDTCxVQUFVO1lBQ1YsaUJBQWlCO1lBQ2pCLGFBQWE7WUFDYixlQUFlO1lBQ2YsWUFBWTtZQUNaLHVCQUF1QjtTQUN4QixDQUFDO0lBQ0osQ0FBQztDQUNGO0FBL0tELGdEQStLQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvc2FzYWthbWEvUHJvamVjdHMvUmltb3Ivc3JjL2ludGVudC1hbmFseXNpcy9UZXN0SW50ZW50UmVwb3J0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZXN0IEludGVudCBSZXBvcnRlclxuICogdjAuOS4wIC0g44OG44K544OI5oSP5Zuz5a6f54++5bqm44Gu44Os44Od44O844OI55Sf5oiQXG4gKiBUREQgR3JlZW4gUGhhc2UgLSDjg4bjgrnjg4jjgpLpgJrjgZnmnIDlsI/pmZDjga7lrp/oo4VcbiAqL1xuXG5pbXBvcnQgeyBDb3JlVHlwZXMsIFR5cGVHdWFyZHMsIFR5cGVVdGlscyB9IGZyb20gJy4uL2NvcmUvdHlwZXMvY29yZS1kZWZpbml0aW9ucyc7XG5pbXBvcnQgeyBUZXN0UmVhbGl6YXRpb25SZXN1bHQsIEludGVudFJpc2tMZXZlbCwgU2V2ZXJpdHkgfSBmcm9tICcuL0lUZXN0SW50ZW50QW5hbHl6ZXInO1xuXG4vKipcbiAqIOODrOODneODvOODiOOCteODnuODquODvFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlcG9ydFN1bW1hcnkge1xuICB0b3RhbEZpbGVzOiBudW1iZXI7XG4gIGNyaXRpY2FsUmlza0NvdW50OiBudW1iZXI7XG4gIGhpZ2hSaXNrQ291bnQ6IG51bWJlcjtcbiAgbWVkaXVtUmlza0NvdW50OiBudW1iZXI7XG4gIGxvd1Jpc2tDb3VudDogbnVtYmVyO1xuICBhdmVyYWdlUmVhbGl6YXRpb25TY29yZTogbnVtYmVyO1xufVxuXG4vKipcbiAqIOODhuOCueODiOaEj+Wbs+Wun+ePvuW6puODrOODneODvOOCv+ODvFxuICogS0lTU+WOn+WJhzog44K344Oz44OX44Or44Gq44Os44Od44O844OI55Sf5oiQ44GL44KJ6ZaL5aeLXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXN0SW50ZW50UmVwb3J0ZXIge1xuICAvKipcbiAgICogTWFya2Rvd27lvaLlvI/jga7jg6zjg53jg7zjg4jjgpLnlJ/miJBcbiAgICogWUFHTknljp/liYc6IOW/heimgeacgOWwj+mZkOOBruWun+ijhVxuICAgKi9cbiAgZ2VuZXJhdGVNYXJrZG93blJlcG9ydChyZXN1bHRzOiBUZXN0UmVhbGl6YXRpb25SZXN1bHRbXSk6IHN0cmluZyB7XG4gICAgY29uc3Qgc3VtbWFyeSA9IHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KHJlc3VsdHMpO1xuICAgIGxldCBtYXJrZG93biA9ICcjIOODhuOCueODiOaEj+Wbs+Wun+ePvuW6puebo+afu+ODrOODneODvOODiFxcblxcbic7XG4gICAgXG4gICAgLy8g44K144Oe44Oq44O844K744Kv44K344On44OzXG4gICAgbWFya2Rvd24gKz0gJyMjIOOCteODnuODquODvFxcblxcbic7XG4gICAgXG4gICAgLy8g6K2m5ZGK6KGo56S6XG4gICAgaWYgKHN1bW1hcnkuY3JpdGljYWxSaXNrQ291bnQgPiAwKSB7XG4gICAgICBtYXJrZG93biArPSAn4pqg77iPICoq6K2m5ZGKKio6IENSSVRJQ0FM44Os44OZ44Or44Gu44Oq44K544Kv44GM5qSc5Ye644GV44KM44G+44GX44GfXFxuXFxuJztcbiAgICB9XG4gICAgXG4gICAgLy8g44Oq44K544Kv57Wx6KiIXG4gICAgbWFya2Rvd24gKz0gYC0gQ1JJVElDQUzjg6rjgrnjgq86ICR7c3VtbWFyeS5jcml0aWNhbFJpc2tDb3VudH3ku7ZcXG5gO1xuICAgIG1hcmtkb3duICs9IGAtIEhJR0jjg6rjgrnjgq86ICR7c3VtbWFyeS5oaWdoUmlza0NvdW50feS7tlxcbmA7XG4gICAgbWFya2Rvd24gKz0gYC0gTUVESVVN44Oq44K544KvOiAke3N1bW1hcnkubWVkaXVtUmlza0NvdW50feS7tlxcbmA7XG4gICAgbWFya2Rvd24gKz0gYC0gTE9X44Oq44K544KvOiAke3N1bW1hcnkubG93Umlza0NvdW50feS7tlxcblxcbmA7XG4gICAgXG4gICAgLy8g57Wx6KiI5oOF5aCxXG4gICAgbWFya2Rvd24gKz0gJyMjIOe1seioiOaDheWgsVxcblxcbic7XG4gICAgbWFya2Rvd24gKz0gYC0g5YiG5p6Q44OV44Kh44Kk44Or5pWwOiAke3N1bW1hcnkudG90YWxGaWxlc31cXG5gO1xuICAgIG1hcmtkb3duICs9IGAtIOW5s+Wdh+Wun+ePvuW6pjogJHtzdW1tYXJ5LmF2ZXJhZ2VSZWFsaXphdGlvblNjb3JlLnRvRml4ZWQoMSl9JVxcbmA7XG4gICAgXG4gICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3Qgc2NvcmVzID0gcmVzdWx0cy5tYXAociA9PiByLnJlYWxpemF0aW9uU2NvcmUpO1xuICAgICAgY29uc3QgbWluU2NvcmUgPSBNYXRoLm1pbiguLi5zY29yZXMpO1xuICAgICAgY29uc3QgbWF4U2NvcmUgPSBNYXRoLm1heCguLi5zY29yZXMpO1xuICAgICAgbWFya2Rvd24gKz0gYC0g5pyA5L2O5a6f54++5bqmOiAke21pblNjb3JlfSVcXG5gO1xuICAgICAgbWFya2Rvd24gKz0gYC0g5pyA6auY5a6f54++5bqmOiAke21heFNjb3JlfSVcXG5gO1xuICAgIH1cbiAgICBcbiAgICBtYXJrZG93biArPSAnXFxuJztcbiAgICBcbiAgICAvLyDmlLnlloTmj5DmoYjjgrvjgq/jgrfjg6fjg7NcbiAgICBjb25zdCBhbGxHYXBzID0gcmVzdWx0cy5mbGF0TWFwKHIgPT4gci5nYXBzKTtcbiAgICBpZiAoYWxsR2Fwcy5sZW5ndGggPiAwKSB7XG4gICAgICBtYXJrZG93biArPSAnIyMg5pS55ZaE5o+Q5qGI77yI5YSq5YWI5bqm6aCG77yJXFxuXFxuJztcbiAgICAgIFxuICAgICAgLy8g6YeN6KaB5bqm44Gn44K944O844OIXG4gICAgICBjb25zdCBzb3J0ZWRHYXBzID0gYWxsR2Fwcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGNvbnN0IHNldmVyaXR5T3JkZXIgPSB7XG4gICAgICAgICAgW1NldmVyaXR5LkNSSVRJQ0FMXTogMCxcbiAgICAgICAgICBbU2V2ZXJpdHkuSElHSF06IDEsXG4gICAgICAgICAgW1NldmVyaXR5Lk1FRElVTV06IDIsXG4gICAgICAgICAgW1NldmVyaXR5LkxPV106IDNcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHNldmVyaXR5T3JkZXJbYS5zZXZlcml0eV0gLSBzZXZlcml0eU9yZGVyW2Iuc2V2ZXJpdHldO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHNvcnRlZEdhcHMuZm9yRWFjaChnYXAgPT4ge1xuICAgICAgICBtYXJrZG93biArPSBgLSAqKlske2dhcC5zZXZlcml0eS50b1VwcGVyQ2FzZSgpfV0qKiAke2dhcC5kZXNjcmlwdGlvbn1cXG5gO1xuICAgICAgICBnYXAuc3VnZ2VzdGlvbnMuZm9yRWFjaChzdWdnZXN0aW9uID0+IHtcbiAgICAgICAgICBtYXJrZG93biArPSBgICAtICR7c3VnZ2VzdGlvbn1cXG5gO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBtYXJrZG93biArPSAnXFxuJztcbiAgICB9XG4gICAgXG4gICAgLy8g5YCL5Yil44OV44Kh44Kk44Or44Gu57WQ5p6cXG4gICAgcmVzdWx0cy5mb3JFYWNoKHJlc3VsdCA9PiB7XG4gICAgICBjb25zdCBmaWxlID0gcmVzdWx0LmZpbGUgfHwgJ3Vua25vd24nO1xuICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSByZXN1bHQuZGVzY3JpcHRpb24gfHwgcmVzdWx0LmludGVudC5kZXNjcmlwdGlvbjtcbiAgICAgIFxuICAgICAgbWFya2Rvd24gKz0gYCMjIyAke2ZpbGV9XFxuXFxuYDtcbiAgICAgIG1hcmtkb3duICs9IGAtIOODhuOCueODiDogJHtkZXNjcmlwdGlvbn1cXG5gO1xuICAgICAgbWFya2Rvd24gKz0gYC0g5a6f54++5bqmOiAke3Jlc3VsdC5yZWFsaXphdGlvblNjb3JlfSVcXG5gO1xuICAgICAgbWFya2Rvd24gKz0gYC0g44Oq44K544Kv44Os44OZ44OrOiAke3Jlc3VsdC5yaXNrTGV2ZWwudG9VcHBlckNhc2UoKX1cXG5gO1xuICAgICAgXG4gICAgICBpZiAocmVzdWx0LmdhcHMubGVuZ3RoID4gMCkge1xuICAgICAgICBtYXJrZG93biArPSAnLSDjgq7jg6Pjg4Pjg5c6XFxuJztcbiAgICAgICAgcmVzdWx0LmdhcHMuZm9yRWFjaChnYXAgPT4ge1xuICAgICAgICAgIG1hcmtkb3duICs9IGAgIC0gJHtnYXAuZGVzY3JpcHRpb259XFxuYDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIG1hcmtkb3duICs9ICdcXG4nO1xuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBtYXJrZG93bjtcbiAgfVxuXG4gIC8qKlxuICAgKiBIVE1M5b2i5byP44Gu44Os44Od44O844OI44KS55Sf5oiQXG4gICAqIEtJU1Pljp/liYc6IOOCt+ODs+ODl+ODq+OBqkhUTUzmp4vpgKBcbiAgICovXG4gIGdlbmVyYXRlSFRNTFJlcG9ydChyZXN1bHRzOiBUZXN0UmVhbGl6YXRpb25SZXN1bHRbXSk6IHN0cmluZyB7XG4gICAgY29uc3Qgc3VtbWFyeSA9IHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KHJlc3VsdHMpO1xuICAgIFxuICAgIGxldCBodG1sID0gYDwhRE9DVFlQRSBodG1sPlxuPGh0bWw+XG48aGVhZD5cbiAgPG1ldGEgY2hhcnNldD1cIlVURi04XCI+XG4gIDx0aXRsZT7jg4bjgrnjg4jmhI/lm7Plrp/nj77luqbnm6Pmn7vjg6zjg53jg7zjg4g8L3RpdGxlPlxuICA8c3R5bGU+XG4gICAgYm9keSB7IGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbWFyZ2luOiAyMHB4OyB9XG4gICAgLmNyaXRpY2FsIHsgYmFja2dyb3VuZC1jb2xvcjogI2ZmNDQ0NDsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAycHggOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IH1cbiAgICAuaGlnaCB7IGJhY2tncm91bmQtY29sb3I6ICNmZjg4MDA7IGNvbG9yOiB3aGl0ZTsgcGFkZGluZzogMnB4IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyB9XG4gICAgLm1lZGl1bSB7IGJhY2tncm91bmQtY29sb3I6ICNmZmFhMDA7IGNvbG9yOiB3aGl0ZTsgcGFkZGluZzogMnB4IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyB9XG4gICAgLmxvdyB7IGJhY2tncm91bmQtY29sb3I6ICM0NGFhMDA7IGNvbG9yOiB3aGl0ZTsgcGFkZGluZzogMnB4IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyB9XG4gICAgLm1pbmltYWwgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMDBhYTQ0OyBjb2xvcjogd2hpdGU7IHBhZGRpbmc6IDJweCA4cHg7IGJvcmRlci1yYWRpdXM6IDRweDsgfVxuICAgIC5wcm9ncmVzcy1iYXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmMGYwOyBoZWlnaHQ6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDEwcHg7IG92ZXJmbG93OiBoaWRkZW47IH1cbiAgICAucHJvZ3Jlc3MtZmlsbCB7IGJhY2tncm91bmQtY29sb3I6ICM0Q0FGNTA7IGhlaWdodDogMTAwJTsgfVxuICA8L3N0eWxlPlxuPC9oZWFkPlxuPGJvZHk+XG4gIDxoMT7jg4bjgrnjg4jmhI/lm7Plrp/nj77luqbnm6Pmn7vjg6zjg53jg7zjg4g8L2gxPlxuYDtcbiAgICBcbiAgICAvLyDlgIvliKXjg5XjgqHjgqTjg6vjga7ntZDmnpxcbiAgICByZXN1bHRzLmZvckVhY2gocmVzdWx0ID0+IHtcbiAgICAgIGNvbnN0IGZpbGUgPSByZXN1bHQuZmlsZSB8fCAndW5rbm93bic7XG4gICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHJlc3VsdC5kZXNjcmlwdGlvbiB8fCByZXN1bHQuaW50ZW50LmRlc2NyaXB0aW9uO1xuICAgICAgY29uc3Qgcmlza0NsYXNzID0gcmVzdWx0LnJpc2tMZXZlbC50b0xvd2VyQ2FzZSgpO1xuICAgICAgXG4gICAgICBodG1sICs9IGA8ZGl2IHN0eWxlPVwibWFyZ2luOiAyMHB4IDA7IHBhZGRpbmc6IDE1cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5gO1xuICAgICAgaHRtbCArPSBgPGgzPiR7ZmlsZX08L2gzPmA7XG4gICAgICBodG1sICs9IGA8cD4ke2Rlc2NyaXB0aW9ufTwvcD5gO1xuICAgICAgaHRtbCArPSBgPHA+5a6f54++5bqmOiAke3Jlc3VsdC5yZWFsaXphdGlvblNjb3JlfSU8L3A+YDtcbiAgICAgIGh0bWwgKz0gYDxkaXYgY2xhc3M9XCJwcm9ncmVzcy1iYXJcIj48ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtZmlsbFwiIHN0eWxlPVwid2lkdGg6ICR7cmVzdWx0LnJlYWxpemF0aW9uU2NvcmV9JVwiPjwvZGl2PjwvZGl2PmA7XG4gICAgICBodG1sICs9IGA8cD7jg6rjgrnjgq/jg6zjg5njg6s6IDxzcGFuIGNsYXNzPVwiJHtyaXNrQ2xhc3N9XCI+JHtyZXN1bHQucmlza0xldmVsLnRvVXBwZXJDYXNlKCl9PC9zcGFuPjwvcD5gO1xuICAgICAgaHRtbCArPSBgPC9kaXY+YDtcbiAgICB9KTtcbiAgICBcbiAgICBodG1sICs9IGA8L2JvZHk+PC9odG1sPmA7XG4gICAgcmV0dXJuIGh0bWw7XG4gIH1cblxuICAvKipcbiAgICog44K144Oe44Oq44O85oOF5aCx44KS55Sf5oiQXG4gICAqIERSWeWOn+WJhzog5YWx6YCa44Gu44K144Oe44Oq44O855Sf5oiQ44Ot44K444OD44KvXG4gICAqL1xuICBnZW5lcmF0ZVN1bW1hcnkocmVzdWx0czogVGVzdFJlYWxpemF0aW9uUmVzdWx0W10pOiBSZXBvcnRTdW1tYXJ5IHtcbiAgICBjb25zdCB0b3RhbEZpbGVzID0gcmVzdWx0cy5sZW5ndGg7XG4gICAgbGV0IGNyaXRpY2FsUmlza0NvdW50ID0gMDtcbiAgICBsZXQgaGlnaFJpc2tDb3VudCA9IDA7XG4gICAgbGV0IG1lZGl1bVJpc2tDb3VudCA9IDA7XG4gICAgbGV0IGxvd1Jpc2tDb3VudCA9IDA7XG4gICAgbGV0IHRvdGFsU2NvcmUgPSAwO1xuICAgIFxuICAgIHJlc3VsdHMuZm9yRWFjaChyZXN1bHQgPT4ge1xuICAgICAgdG90YWxTY29yZSArPSByZXN1bHQucmVhbGl6YXRpb25TY29yZTtcbiAgICAgIFxuICAgICAgc3dpdGNoIChyZXN1bHQucmlza0xldmVsKSB7XG4gICAgICAgIGNhc2UgSW50ZW50Umlza0xldmVsLkNSSVRJQ0FMOlxuICAgICAgICAgIGNyaXRpY2FsUmlza0NvdW50Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgSW50ZW50Umlza0xldmVsLkhJR0g6XG4gICAgICAgICAgaGlnaFJpc2tDb3VudCsrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEludGVudFJpc2tMZXZlbC5NRURJVU06XG4gICAgICAgICAgbWVkaXVtUmlza0NvdW50Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgSW50ZW50Umlza0xldmVsLkxPVzpcbiAgICAgICAgICBsb3dSaXNrQ291bnQrKztcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCBhdmVyYWdlUmVhbGl6YXRpb25TY29yZSA9IHRvdGFsRmlsZXMgPiAwID8gdG90YWxTY29yZSAvIHRvdGFsRmlsZXMgOiAwO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbEZpbGVzLFxuICAgICAgY3JpdGljYWxSaXNrQ291bnQsXG4gICAgICBoaWdoUmlza0NvdW50LFxuICAgICAgbWVkaXVtUmlza0NvdW50LFxuICAgICAgbG93Umlza0NvdW50LFxuICAgICAgYXZlcmFnZVJlYWxpemF0aW9uU2NvcmVcbiAgICB9O1xuICB9XG59Il0sInZlcnNpb24iOjN9